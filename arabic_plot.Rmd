---
title: "arabic_plot"
output: html_document
---

```{r message=FALSE, warning=FALSE}

# Load Packages

list.of.packages <- c("tidyverse",
                      "RCurl",
                      "arabicStemR"
                      )

new.packages <- list.of.packages[!(list.of.packages %in% installed.packages()[,"Package"])]
if(length(new.packages)) install.packages(new.packages)



library(tidyverse)
library(RCurl)
library(arabicStemR)


# Get a work of Alghazali from al-Kitab corpus.

ihya <- getURL("https://raw.githubusercontent.com/OpenITI/0525AH/master/data/0505Ghazali/0505Ghazali.IhyaCulumDin/0505Ghazali.IhyaCulumDin.JK000001-ara1")


# Pre-processes the text

    ihya_cleaned <- ihya %>%
      cleanChars() %>%
      fixAlifs() %>%
      removeDiacritics() %>%
      removePunctuation() %>%
      removeNumbers() %>%
      removeNewlineChars()
    
# Make it dataframe
    
    df_ihya <- data.frame(word = unlist(strsplit(as.character(ihya_cleaned), " ")))





# Visualize

df_ihya %>%
  count(word, sort=T) %>% 
  slice(1:15) %>% 
  ggplot(aes(word,n)) +
  geom_col() +
  labs(x="الكلمة",
       y= "",
       title = "إحياء علوم الدين",
       subtitle="الكلمات الآكثر استخدامًا") +
   annotate("text", x = 5, y = 26000, label = "الكتاب المهم", colour="red") 



# Alignet to right

df_ihya %>%
  count(word, sort=T) %>% 
  slice(1:15) %>% 
  ggplot(aes(word,n)) +
  geom_col() +
  labs(x="الكلمة",
       y= "",
       title = "إحياء علوم الدين",
       subtitle="الكلمات الآكثر استخدامًا") +
   annotate("text", x = 5, y = 26000, label = "الكتاب المهم", colour="red") +
  theme(plot.title = element_text(hjust = 0.99),
        plot.subtitle = element_text(hjust = 0.99))


```

